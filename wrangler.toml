send_metrics = false
account_id = "fb531f0c4c22637ae5d5e812ca3e56b1"
name = "collabboard"
main = "src/server/index.ts"
compatibility_date = "2025-02-01"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = "dist"

[[d1_databases]]
binding = "DB"
database_name = "collabboard-db"
database_id = "746bc930-1ec4-4424-9209-29ca4f185f43"

[durable_objects]
bindings = [
  { name = "BOARD", class_name = "Board" },
  { name = "CHAT_AGENT", class_name = "ChatAgent" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["Board"]

[[migrations]]
tag = "v2"
new_sqlite_classes = ["ChatAgent"]

[observability]
enabled = true

[observability.logs]
invocation_logs = true

[ai]
binding = "AI"

[vars]
# Daily AI spend cap in USD (neurons priced at $0.011/1K).
# Tracked per ChatAgent DO instance, resets at midnight UTC.
DAILY_AI_BUDGET_USD = "5.00"
# Workers AI model. Override to test different models without redeploying.
WORKERS_AI_MODEL = "@cf/mistralai/mistral-small-3.1-24b-instruct"
# Set to "true" to route AI through Anthropic API (requires ANTHROPIC_API_KEY secret).
# Default "false" = all AI via Workers AI (Mistral Small 3.1).
ENABLE_ANTHROPIC_API = "false"

# AUTH_SECRET set via: wrangler secret put AUTH_SECRET
# ANTHROPIC_API_KEY set via: wrangler secret put ANTHROPIC_API_KEY
#   Only used when ENABLE_ANTHROPIC_API = "true"
#   For local dev: add to .dev.vars file
